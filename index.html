<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Flappy Bure Mobile</title>

<style>
html, body {
  margin: 0;
  padding: 0;
  overflow: hidden;
  background: #70c5ce;
  touch-action: manipulation;
}

canvas {
  display: block;
}
</style>
</head>

<body>
<canvas id="game"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

function resize() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
resize();
window.addEventListener("resize", resize);

let bure, pipes, score, gameOver;
const gravity = 0.45;
const jump = -8.5;
const pipeGap = 160;
const pipeWidth = 70;
const speed = 2.5;

function reset() {
  bure = {
    x: canvas.width * 0.25,
    y: canvas.height / 2,
    r: 14,
    v: 0
  };
  pipes = [];
  score = 0;
  gameOver = false;
}

reset();

function tap() {
  if (gameOver) reset();
  bure.v = jump;
}

canvas.addEventListener("touchstart", tap);
canvas.addEventListener("mousedown", tap);

function spawnPipe() {
  const top = Math.random() * (canvas.height - pipeGap - 200) + 100;
  pipes.push({
    x: canvas.width,
    top,
    passed: false
  });
}

function drawBure() {
  ctx.beginPath();
  ctx.arc(bure.x, bure.y, bure.r, 0, Math.PI * 2);
  ctx.fillStyle = "#ffcc00";
  ctx.fill();
}

function drawPipes() {
  ctx.fillStyle = "#2ecc71";
  pipes.forEach(p => {
    ctx.fillRect(p.x, 0, pipeWidth, p.top);
    ctx.fillRect(p.x, p.top + pipeGap, pipeWidth, canvas.height);
  });
}

function collision(p) {
  return (
    bure.x + bure.r > p.x &&
    bure.x - bure.r < p.x + pipeWidth &&
    (bure.y - bure.r < p.top ||
     bure.y + bure.r > p.top + pipeGap)
  );
}

function drawUI() {
  ctx.fillStyle = "#000";
  ctx.font = "bold 32px Arial";
  ctx.fillText(score, canvas.width / 2 - 10, 60);

  if (gameOver) {
    ctx.fillStyle = "#000";
    ctx.font = "bold 40px Arial";
    ctx.fillText("GAME OVER", canvas.width / 2 - 120, canvas.height / 2);
    ctx.font = "20px Arial";
    ctx.fillText("Tap pour rejouer", canvas.width / 2 - 70, canvas.height / 2 + 40);
  }
}

let frame = 0;

function update() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  if (!gameOver) {
    bure.v += gravity;
    bure.y += bure.v;

    if (frame % 110 === 0) spawnPipe();

    pipes.forEach(p => {
      p.x -= speed;

      if (!p.passed && p.x + pipeWidth < bure.x) {
        p.passed = true;
        score++;
      }

      if (collision(p)) gameOver = true;
    });

    pipes = pipes.filter(p => p.x + pipeWidth > 0);

    if (bure.y + bure.r > canvas.height || bure.y - bure.r < 0) {
      gameOver = true;
    }
  }

  drawPipes();
  drawBure();
  drawUI();

  frame++;
  requestAnimationFrame(update);
}

update();
</script>
</body>
</html>
